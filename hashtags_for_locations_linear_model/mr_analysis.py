'''
Created on Sept 9, 2012

@author: kykamath
'''
from collections import defaultdict
from datetime import datetime
from library.geo import UTMConverter
from library.mrjobwrapper import ModifiedMRJob
from library.twitter import getDateTimeObjectFromTweetTimestamp
from operator import itemgetter
import cjson
import time


ACCURACY = UTMConverter.accuracy_10KM

# Minimum number of hashtag occurrences
# Used by HashtagsExtractor
MIN_HASHTAG_OCCURRENCES = 1000

# Minimum number of hashtag occurrences at a particular utm id.
# Used by HashtagsByUTMId
MIN_HASHTAG_OCCURRENCES_PER_UTM_ID = 500

# Start time for data analysis
START_TIME, END_TIME = datetime(2011, 3, 1), datetime(2012, 7, 31)

# Valid utm ids.
dense_utm_ids = ['-7.28187684306_110.139395038', '41.6577580877_-83.582172075', '45.3783541629_9.19158346375', '50.6711691742_7.08949255105', '32.0410786529_-81.1588759863', '50.4108825139_-4.19628226619', '52.3809770619_4.83652628101', '-5.19718120032_119.480721621', '40.2291942388_28.9394342725', '51.2951971067_-0.776808900092', '53.1845568884_-6.82997018', '3.57358813217_98.6848567357', '37.7199536848_-122.262459623', '41.4130525526_2.10259967743', '-20.5580307237_-48.6499667454', '-22.718276665_-47.7744966871', '39.063662999_-94.5603990956', '41.0466391595_-73.5126756572', '47.2669357544_39.594876146', '-3.11695530309_-59.9864006205', '30.4930427399_-91.0724388593', '33.7219456774_-84.1401594954', '-22.6342997898_-47.3838127161', '-7.00373214232_107.669943819', '18.9360952334_-96.9583642637', '30.4028540095_-91.0742133735', '-22.9104586693_-46.9987598603', '29.6746889009_-95.3249965118', '47.5222462518_19.0738673351', '-29.8755812258_-51.0517771064', '32.9201200751_-96.5938725915', '41.0395161495_28.9630335496', '41.5931793353_2.10010911301', '-6.28434670135_106.853028804', '38.3531457066_27.0572248458', '43.1157041947_-79.3406266276', '57.1560290596_-2.25610881613', '-23.5469580626_-46.6164862293', '41.3004248563_12.5514152234', '42.2975850019_-83.122950464', '43.7349531044_11.2972478861', '48.8869631227_2.52256094426', '21.6581794198_-104.855025484', '39.3322746067_-76.6823735464', '41.4139235542_2.22224165917', '26.1724637282_-80.2494959958', '35.8276168919_-86.3910803179', '41.4152923447_-81.5384604793', '-7.27888679907_-34.8568338703', '38.2630214903_14.9428459249', '44.0072967297_-78.8170020777', '45.3763547985_-75.7024481326', '-28.2429429732_-52.4779754232', '1.49202664863_124.842584493', '33.904571654_-84.2421866899', '37.5253825866_127.019571811', '38.9684457093_-76.9045734308', '53.8265757942_-1.7085992658', '41.5940558354_21.7799169498', '52.475046986_-1.4540493982', '20.5667433482_-97.4170508128', '35.1976807402_-80.7253706084', '35.8998765787_-78.8392908837', '40.4248962403_-80.587402312', '53.1787319093_-0.530941446071', '33.997038021_-84.3474369868', '35.6254306091_-77.3741089197', '38.4315051474_-121.338740951', '38.7135155232_-9.17253301377', '42.0451245588_-87.664578044', '52.8428659446_-2.33188182154', '-23.457648378_-46.5175101817', '22.2784701323_-100.989654485', '31.5767657943_-97.1558390268', '32.5821779931_-86.7336282318', '50.5968767612_3.07064553213', '40.6045876868_-75.5319003541', '43.6574928317_-79.4497924238', '53.7434283693_-2.77256151716', '-22.919077245_-49.8785641867', '3.11769657788_101.74394336', '32.2215104901_-110.840810984', '33.4783123772_-112.237738549', '32.7628659462_-117.053381772', '38.6081769429_-76.8950084801', '39.0585091057_-76.9069915355', '13.7891778439_100.618851442', '29.4231302825_-98.4329980898', '40.8693412357_-4.24601925908', '33.7290175581_-84.4636199758', '52.9200940811_-1.14073847665', '-25.4301246847_-54.46461492', '32.6726581271_-117.053328062', '33.9896093161_-83.9770030142', '39.4239674966_-76.5684047746', '40.6039829126_-74.3499061419', '52.0274831872_4.38470077593', '-33.4717716348_-70.7756945922', '31.9477750687_-99.8993703449', '39.0565624226_-77.0225015191', '37.7107827698_-97.3549663293', '38.9622824875_-95.2506296766', '42.6716081672_-73.8406369078', '53.7349904543_-1.55980047969', '-22.2702939143_-42.4284059566', '-6.5555891062_106.854009964', '45.5583768667_9.19219429311', '53.2024171085_-2.32630345552', '-23.4465946023_-47.3981564869', '-7.46007894326_109.232996664', '14.690096196_121.003340649', '25.7175973653_-100.246004093', '39.6140375568_-75.4077425523', '51.6385909867_-0.0373556729699', '51.0465152419_-3.07132727585', '51.5557065714_-0.331310519354', '28.5924801072_77.3007582217', '32.6536315002_-96.8142357485', '50.7610484357_-1.08583385069', '51.0447741937_3.6419241832', '53.56194603_-2.32060424364', '25.7167112164_-100.345663369', '36.9039926474_-76.2908304855', '37.9826077772_-79.4627759637', '51.2184770822_4.36028823774', '52.286205635_-0.874148079824', '-22.0966850982_-42.9160033373', '30.6831457894_-88.0962270531', '19.5799467164_-99.0476735732', '40.2450736211_-74.7060684621', '42.7475653018_-71.1382467238', '36.0974635986_-80.2779168045', '38.9644508131_-77.1352894805', '46.1854738489_2.15773729835', '-0.94968447832_100.392997853', '13.7897693255_100.526369608', '-6.5532915946_107.396360922', '41.5948071505_-87.6599380784', '44.5674870893_3.44077271439', '10.3568784819_123.867756226', '19.0363349653_-98.2872699198', '38.777541992_-77.4750159012', '55.6216153125_-4.50857930915', '-22.3605446117_-47.5732487574', '-23.8188291748_-46.5216802791', '-32.2146513659_-52.3264247347', '18.0435102811_-92.9527573804', '38.4345293554_-82.4321914549', '41.6675457034_-72.8978852467', '38.2629101429_140.82853809', '41.4146701561_-75.6581114761', '51.5487952132_-0.0431968072903', '1.40223311489_110.32580903', '18.1283275277_-94.4650956048', '28.5157311629_-16.2774018207', '49.5166119975_8.51646060555', '51.6421463615_-0.181681778281', '53.5552780023_-1.56591150198', '33.9302195962_-118.136049165', '38.1667923622_-85.8013647781', '28.6112206621_-81.4602981165', '37.8063542405_-85.8072151657', '-22.6429790785_-43.2969991263', '35.3611738578_-119.036205986', '37.4488129316_-122.152075059', '-12.9801928481_-38.4928596352', '40.0652408276_-75.0586314869', '-23.1009795283_-45.927659594', '25.6311865847_-80.3525215297', '28.0699290223_-80.6437997385', '52.7403946568_-1.14839735757', '53.3812378382_-2.17314459822', '-20.9134256463_-54.2600993095', '1.49251450363_103.876350292', '35.1924996782_-79.8466546709', '-21.8321225342_-46.499751017', '34.0256380324_-81.0541593961', '37.8875668873_-1.12361626062', '6.01556734706_116.141594973', '-8.00174157684_-34.9506560849', '32.5553678468_-83.6092883508', '37.9865761654_-121.804303018', '42.3152977851_-3.66741329047', '56.7090278724_-2.91832891675', '35.5519910493_139.731203083', '39.6094823419_-79.8933540069', '45.0180095485_-93.3172967238', '-23.5488707396_-46.4205984788', '-27.5968128336_-48.5178260211', '-6.19453227982_106.672013909', '0.0451737731998_-0.00916767807201', '27.5276221319_-99.5569685616', '30.0335020417_-95.4370037611', '50.8531737065_-1.22414307778', '-23.6382409649_-46.5195848627', '14.4182126763_120.913065768', '39.8849261518_32.8245672251', '-22.9221310061_-45.5363694158', '41.1178456517_-77.5608838816', '41.5047393692_-81.6590227004', '47.2669357544_-122.405123854', '53.6483840604_-1.86534521171', '-5.19752946629_119.390567686', '33.7498719935_-118.133664973', '34.656340918_-86.6180363895', '39.4338312355_-87.4066900663',
'40.6915170861_-73.9940004261', '53.1721571473_-0.23202314635', '-7.55404773752_110.864026635', '41.5021181436_-73.9815553079', '53.4635209751_-1.41836470668', '33.9134968614_-83.3255564207', '40.8705620297_-73.8726261838', '51.7353406445_-0.320735644626', '53.5533732177_-1.41501525064', '-20.4801194404_-46.1027016669', '-5.19818740779_-42.7897579883', '-24.0069782418_-50.9508384973', '21.0052006736_-89.6454302512', '39.1485709807_-76.9094204924', '36.1896803064_-86.833168984', '44.9284130497_-93.0633606131', '-6.19480940892_106.581658823', '-7.46043181955_112.676414958', '28.521265613_-81.357706157', '41.1455633515_-8.58291790801', '42.3828228096_-71.3687598175', '-40.8573812682_174.923717319', '40.9635677049_-74.22755317', '-2.57804443075_118.034459668', '-7.91252117441_112.678189955', '34.1152517846_-117.379514137', '7.09460445396_125.580000977', '-23.003082251_-43.1949644673', '-28.5071258278_-49.0075446415', '40.3337281553_-3.64749305877', '41.3264602655_-105.059747722', '19.1156528778_72.8611412667', '29.9350335217_-90.1511611002', '41.8650018974_-87.6627093539', '-23.7346977004_-45.6377555298', '37.6135063445_-0.903948095928', '40.8551852917_-0.805153348461', '42.2975850019_-71.122950464', '45.5520544286_-73.7829043842', '51.2025427858_0.63811372031', '-40.591286756_-73.1683062488', '14.5997363218_121.00415852', '34.016957984_-118.462095073', '34.6568292993_135.163700003', '38.237316795_-0.543417929835', '39.4951942073_-0.383438157077', '48.6146947628_-2.1181022224', '55.8960629603_-4.03943753478', '-22.7147810381_-42.0309963206', '-23.5497346178_-46.3226471844', '29.7610645109_-95.5337664496', '35.6184497687_78.2949302152', '50.8459130641_5.2017589342', '33.7332620033_-84.6793200864', '34.7461257538_135.491626005', '34.9273607074_134.835764503', '41.0554849252_-80.5834873816', '42.3828228096_-83.3687598175', '51.5619108949_0.619533292892', '53.3835095223_-2.62413960744', '-9.99536605502_-68.2244541621', '33.1023937779_-96.6960502457', '40.334806479_-80.5879515456', '42.3918318563_-82.8831480474', '16.2344714275_-92.2982008182', '26.2621931742_-80.1487803407', '37.7211549541_-122.489385013', '29.3328801263_-98.4334981215', '37.6154641291_-121.017184224', '43.0317468458_-76.1661196088', '51.1205496281_16.9289897403', '52.383168068_-1.31032345742', '19.7578878661_-88.0022107951', '29.672836122_-95.4282540638', '3.57355268557_98.5948171514', '4.65862615254_-74.0533274694', '19.6702667089_-99.1431005534', '19.6703173585_-99.0477002338', '28.9678734103_-106.180289532', '40.5138994175_-3.64922300725', '53.3517269804_-114.220395247', '-23.7275399881_-46.6187056015', '52.4799939108_-1.89564259065', '3.20830095386_101.65427405', '40.424415459_-3.53047848175', '52.1189932024_4.24147291101', '-25.5203409365_-48.462721313', '29.4235291615_-98.5360862293', '20.1220011498_-98.7608219324', '42.4728055266_-83.3721520054', '54.10294683_-3.22940110814', '33.8120254891_-84.1371631477', '38.786386247_-77.0148428043', '51.4863907059_7.48772049444', '42.8571756253_-2.69399089119', '53.6277508072_-0.504792100739', '41.1315150875_28.8466423065', '48.8855109321_2.24975864181', '37.7191892788_-122.149002596', '33.48027506_-112.022512697', '32.833914493_-96.8098273785', '51.8369690257_0.895378538458', '-19.5722383479_-43.3316882458', '-23.5423934097_-47.0081930576', '32.5729659052_-85.4552786283', '41.6848734993_-87.6608576319', '25.9923671538_-80.3505550378', '51.4625302939_0.19276809201', '19.3990530324_-98.7618972627', '21.114152481_105.818470694', '40.4212906546_-79.9980373868', '44.4637632173_-73.1771839156', '16.7779830682_-93.140755384', '17.9526646977_-92.5750371999', '25.81177913_-98.3515429782', '34.2007307957_-118.139665448', '39.885044088_-75.0584777064', '55.6959786596_12.5337891098', '43.7457453212_-79.3233191137', '0.226182760544_-51.0449340808', '33.5488054991_-84.468901433', '36.6309928699_-4.50994566438', '48.4236738186_31.1752123029', '53.6531629997_9.37825451519', '-22.3710300162_-43.2032250007', '39.9609507136_-82.8147580889', '41.4852752761_-72.7840134143', '52.3886465242_-1.75097488833', '-6.37507810226_106.762973599', '28.9722588397_-111.461886692', '51.3691981086_-0.0547887150973', '54.539476663_-1.22244796974', '59.9314800176_10.6998007803', '26.8785951803_-101.265018941', '41.592177666_1.98014086879', '42.2097585328_-70.9988675729', '-23.6391704584_-46.421571385', '34.0242069726_-117.595739344', '36.5497707084_-87.3910696682', '53.0099414493_-1.13687835853', '39.1521326465_-76.678074691', '39.7030839644_-75.6415595865', '5.92496701775_116.051400151', '51.6757726426_-3.21693429104', '13.8795627216_100.619476649', '25.0754701687_-101.131604325', '34.7417162765_-118.147044282', '40.4993154703_-88.9471943551', '42.2875800198_-83.6077541464', '-16.3164420706_-48.9876484867', '50.8338172436_-0.230681452007', '-5.10714289875_119.390229723', '-6.64491200355_-36.8744046795', '25.8107522752_-80.1520330885', '51.853089106_-2.20144632485', '-22.8133291068_-47.4843013181', '32.8421225382_-97.3437916672', '35.9018188211_-78.9500310835', '40.7815896701_-73.9926425629', '51.3850489667_-0.77245585007', '-29.8755812258_-50.9482228936', '-8.0029378409_112.678557874', '33.911407593_-84.5663617703', '48.7963641999_2.38725537089', '56.4395049697_-2.91890775116', '-6.19393190415_106.852711149', '-7.18847586548_-34.8564643272', '19.2174178634_-99.6183759417', '35.8056024623_-78.6205380483', '37.6304802882_-122.376675097', '-16.5944412782_-43.9219574236', '-22.7352347906_-43.4905836679', '52.0215344826_1.17823567194', '52.3913862565_-2.04481199309', '-19.93859689_-43.9966541911', '-21.1825905676_-47.8410855823', '32.6554426839_-96.9207962537', '53.7395925574_27.985490797', '48.2495114129_16.4144414045', '41.2215477624_-73.1508265378', '-9.71703107775_-36.6758507838', '33.1997329436_-97.1225496012', '33.8400464739_-118.134854418', '-22.2784701323_-46.9896544854', '-26.2500476864_-48.9474948592', '32.4799990176_-94.7559499803', '37.2656542061_-121.815797503', '40.601443055_-73.9953521637', '40.7804943569_-73.8741505706', '41.0558535808_-80.702489147', '34.1972742042_-118.46520092', '51.4589975864_-0.0490077528107', '51.6722119085_-3.93998405945', '-7.19212655491_-39.3170123769', '52.3901076729_-1.89788753949', '32.3093106647_-86.2032988545', '39.70366987_-75.5249175034', '41.12745026_29.0847764732', '43.0329316555_-88.0433912613', '-33.5619244103_-70.7775379999', '-7.91287600622_112.587501468', '-7.91133859315_-34.9502286116', '50.7610484357_7.08583385069', '-20.2965979856_-40.4844349026', '38.9702722119_-76.7891988812', '-1.40092117083_-48.4388743406',
'25.81177913_-80.3515429782', '26.0821744864_-80.2500727605', '35.9192055885_-86.8337388336', '40.6878777801_-73.6390246342', '51.4959420173_-3.2160795829', '53.4737752552_-2.77400580376', '53.5632798749_-2.62254783472', '19.3074393623_-98.2861033717', '50.938374252_6.9362191027', '-3.03079823774_104.775019302', '34.0181977396_-118.353819324', '37.4139133643_-5.99427966323', '51.9419130075_-2.05438890875', '-15.4189276237_-55.835060329', '16.9576088436_-99.704427894', '34.1959301493_-118.573699563', '-11.8879573803_-53.0656304585', '-8.17838816569_113.677206259', '32.8257102157_-83.6171692445', '51.2894023554_0.490224028366', '51.4800254349_-1.05587841924', '52.6334045251_-0.266171486763', '53.2042979636_-2.92514203083', '19.4892742885_-99.3335273605', '38.223976815_-5.97278688389', '38.5231618774_-121.451343757', '-6.37442842041_106.943724013', '-8.18209769174_-35.0422561477', '43.2177692302_-2.93843873921', '51.9181993651_-0.455293557909', '19.4895751697_-99.0476470601', '-23.4566654533_-46.615384803', '35.7155172985_-78.6232205031', '38.966505232_-77.0199371813', '32.4751415287_-84.9249528338', '39.1630513482_-86.4791239004', '39.3432631589_-74.4777888389', '51.738551717_-0.46540360075', '52.5711655702_-2.04091010887', '-1.6718214356_113.741065977', '-6.2846591029_106.762666946', '33.3031569772_-87.4833746064', '34.022966811_-117.812355273', '36.9094012349_-2.38259136679', '38.8764465062_-6.98261570503', '40.7792774105_-73.7556654589', '41.6675457034_-0.897885246668', '43.5674845712_1.45210320138', '-20.2090797765_-70.1007802798', '-23.371939061_-51.9295345871', '25.9010427392_-80.151388718', '38.433073198_-121.453270455', '-29.3288270029_-49.8155770083', '42.0148717345_-71.7173382218', '50.4122443877_-4.05557026528', '57.6631920316_11.933680098', '38.0547983392_-84.435577652', '42.4960521724_-2.4523642881', '29.9433376303_-95.4348014242', '31.7586049654_-115.257812729', '38.9622824875_35.2506296766', '41.6735711323_-4.74192913607', '-19.8487542599_-44.09271639', '-22.9183588156_-43.7810643631', '-23.5459092899_-46.7144220195', '-3.29936007623_114.615273254', '-30.3900835348_-53.6538962063', '19.4895250223_-99.1429410332', '21.8174935847_-102.33989719', '41.2362586732_-80.8210035032', '-22.5590322325_-44.0760063481', '51.3822302135_0.628871520786', '54.6047528465_-6.01923122046', '-5.65328974609_-37.8712748922', '38.68242406_-90.2983730915', '40.3330093043_-3.76520988702', '43.6557440533_-79.3258260653', '45.01631708_-86.3019677854', '53.5379504568_-113.489921603', '-7.55401010961_110.773378112', '32.5634878609_-96.8164252266', '40.7834153212_14.2296442948', '41.2892767982_-96.074190913', '42.281810078_-71.8500572611', '42.2952757376_-83.2441741025', '-22.8245867659_-43.3921725349', '20.5683909598_-100.391122044', '34.1858528628_-119.224517157', '19.218405741_-99.1427050616', '42.1197492865_-70.9960351321', '51.3002907064_1.06348339458', '53.3715857611_-1.2714532737', '21.3828566815_-100.205782324', '30.0251678468_-89.8514145969', '30.2363151346_-93.2598252474', '33.8191213373_-84.460961584', '37.9002025085_-122.260664454', '53.7417021722_-2.31770821845', '36.2675024338_-115.274448878', '39.2386313328_-76.9118603549', '40.6933369801_-74.2306827812', '51.4625302939_-0.19276809201', '-22.2718011953_-48.5253765758', '-22.5493288718_-43.006482921', '-27.4384486667_153.050593201', '43.5705692609_-79.6996979154', '47.6889462368_17.5985994116', '52.6582866923_-1.7433023176', '40.0574089576_-76.3483482037', '40.241132476_-74.0006984794', '-19.6452225527_-48.0035752455', '-36.7126858717_-71.0713130853', '3.02733046653_101.743712442', '43.1026385711_-89.3963381123', '23.6270920019_-102.598567147', '25.261170227_-103.262255285', '42.9275462285_-78.8555358277', '2.03486490282_103.426532118', '38.2568983093_-85.7998857953', '40.4230933683_-3.76622977537', '45.4322934778_11.8765047942', '51.7415848208_-0.610097715565', '53.2619429645_-6.22622477342', '33.3900919905_-82.021455455', '39.1423682907_-77.256355758', '41.5039904139_-87.778835191', '52.0139656957_-0.741344081671', '20.6561614844_-103.320154506', '34.1095090605_-118.246857339', '41.5047393692_-87.6590227004', '42.5574785209_-5.61897078709', '55.0016484109_-2.76549986534', '-19.5635789329_-42.5694625207', '-22.7286505359_-42.9065517208', '29.7648641976_-95.3270768846', '36.0949920971_-79.9446904809', '40.3351659328_-74.7056779094', '40.5145022825_-74.4688121876', '51.4775505419_-0.911968702409', '19.2183069493_-99.2378412824', '34.0236345799_-117.704048964', '-15.8540387844_-48.0590757673', '-23.6450587282_-45.4412250113', '32.5652928128_-96.9228791823', '34.1138159354_-117.704795337', '43.1264002323_-8.44677453825', '-21.6399681835_-41.4637029239', '52.4823761545_-2.19010011656', '42.4775819118_-83.1290269424', '51.3982666202_7.63438481823', '-23.1027916998_-45.5370841581', '1.31160434578_103.876436555', '35.7216097519_-6.95465951298', '38.9735831709_-76.5584199951', '43.4850964149_-3.80381522607', '-23.6361963031_-46.7155959327', '1.49246644556_103.786471355', '33.8409938794_-118.02678904', '-7.82415038302_112.043066901', '34.110561759_-118.138454658', '34.1148688805_-117.487943677', '4.65874177039_-74.1434795948', '53.8248444651_-1.55672007225', '-15.8540387844_-47.9409242327', '39.7948260494_-104.824796342', '42.2928384557_-83.3653831198', '33.7267542578_-84.3557873586', '51.5647477315_0.763681917215', '54.9009765444_-1.36252263757', '42.5697797774_-83.0103278081', '52.0080205913_-0.450198843777', '39.8849261518_-75.1754327749', '43.1240228695_-87.9220050172', '-22.9158446201_-43.4885906927', '51.9392170065_4.23650374597', '38.9600002921_-77.3659571184', '41.3074883868_-72.9094965051', '42.2997662064_-83.0017129913', '42.5837730761_-87.9140025822', '53.4699768238_-2.02076613853', '-3.8441815259_-40.2158373738', '32.9399806999_-80.0907208893', '40.6924876762_-111.887661099', '42.2270336306_-8.81823160733', '44.1075113027_-79.4380763495', '54.8131412571_-1.52170169938', '-1.58280480162_103.606664075', '17.1265038864_-96.6972689402', '29.6781533499_-95.1184535141', '39.7678047509_30.4898763735', '50.8303624995_-0.0888561141821', '32.4897179906_-93.7982871751', '52.5750266051_9.07378173415', '-8.72584237233_115.227471672', '13.6993797334_100.52578431', '34.0015157451_-84.5637934037', '-22.725982185_-47.2880732553', '39.2438182135_-76.5643839917', '39.9590591328_-82.9317783905', '41.7503806329_-72.534381893', '-3.75444042526_-38.5046790917', '33.9069449547_-84.3502328222', '37.9886709134_-122.03202137', '35.1978800403_-80.8352218259', '41.035218966_29.2008183505', '20.7482526301_-100.488796845',
'25.7147346161_-103.455033007', '42.7647751546_-75.7944384984', '43.5469760204_-5.6614464385', '-19.9380315859_-43.901110017', '-22.820177858_-43.0025608206', '2.93718244008_101.653603924', '36.7224800393_-4.39976127422', '42.4818428441_-82.8858459477', '-6.46517530702_106.853678208', '30.4043472951_-91.1782644916', '31.1342301606_-100.10138132', '35.6184497687_-78.2949302152', '-23.1825069416_-46.9051092348', '-25.1780884694_-50.0572281666', '23.4602288963_-106.223856731', '40.5131760028_-74.2327457223', '30.0555832797_140.636907676', '41.4139235542_-81.7777583408', '44.4782934894_8.93712846072', '45.1006704433_7.6654319914', '-21.7409020199_-46.5954814434', '26.1719072843_-80.1494370899', '26.2627518256_-80.2489164866', '50.7586358919_-0.944137819769', '-7.73457596337_110.410544049', '3.20806251618_101.744181104', '43.3030313385_-79.9520007668', '51.3002907064_-1.06348339458', '52.3002199925_-1.90012068575', '53.3838881589_-2.77448206149', '-12.8897687915_-38.4930422609', '30.5703678618_-96.3412051898', '36.0939623991_-79.8336249968', '-6.37476117052_106.853351156', '39.3338935971_-76.5663898752', '39.9609507136_-76.8147580889', '-23.3682680481_-46.4186671575', '-25.531963034_-49.2583718586', '-36.8046761649_-73.038294827', '29.9327546878_-90.0476798107', '38.2556738994_-85.6856157844', '-26.884475711_-49.137461125', '38.790129222_-76.7846856344', '50.9451384884_-1.36299760991', '59.2816421252_18.103781288', '-29.8754999777_-51.1553311074', '26.0816202466_-80.1500907289', '51.5796470416_-1.77328030451', '37.8100787969_-3.73843596044', '1.31164333004_103.966311381', '39.7916521252_-86.1240279681', '40.9532814194_28.7228534961', '44.0175106552_-88.5595586097', '33.8426045816_-117.810644396', '-0.497600741077_117.134806138', '-22.9116553575_-43.0986981733', '40.3211518983_-76.824370119', '41.5940558354_-87.7799169498', '51.5523392321_0.187239299403', '25.5352080691_-97.5568537588', '49.1576356338_-123.205729147', '50.9560696669_-2.64405589605', '-0.588060435563_111.404421418', '-23.0884219233_-47.1965760115', '-34.0894236417_18.4529151542', '-34.6493096494_-58.3639982319', '37.3568522549_-121.927279858', '-10.0742089932_-48.1262793324', '53.7382501791_-1.86292590516', '31.8594116128_-81.5813958991', '43.3610920456_-5.90010825214', '51.7653286319_-3.36227248166', '-6.19360866501_106.943052844', '37.5418693678_14.8302028978', '49.1236160387_6.19013236538', '54.9029775847_-1.51841175879', '35.7322762484_139.728349399', '38.7750481637_-90.4099740121', '42.47977683_-71.0074430387', '42.5718522735_-82.8885562388', '51.5523392321_-0.187239299403', '35.9125558348_139.725470257', '38.7697214789_-90.1799981708', '53.37555964_-1.57195693375', '-7.00833284561_-37.3252527859', '-7.27959335227_112.67573502', '41.773300332_2.09759577649', '55.8910802516_-4.51901832675', '-20.1174340244_-40.2914428973', '39.7937680197_-75.5256017225', '41.8403668553_12.5309284932', '-20.5580307237_-47.3500332546', '-22.9148869572_-43.3911091565', '-23.0051860755_-43.3900403912', '-8.63543347833_115.227895989', '-27.7806981322_-48.7165639645', '-7.82502763429_110.41041773', '33.016027989_-96.9123710024', '38.8783807932_-76.9021661253', '54.6293036977_-1.21853209444', '-9.53366592338_-35.687034464', '32.7437737117_-96.8120364792', '41.7749384152_-87.661781383', '46.8827772009_-71.4281330859', '-8.99827897991_-64.5010023077', '37.437136812_127.134923848', '42.47977683_-83.0074430387', '-12.1668127871_-39.0459593856', '-20.1221568786_-44.9521642366', '-22.4660101476_-46.3121240501', '30.3213454048_-97.8038138742', '40.5138994175_-74.3507769928', '-26.9671557907_-48.6324980854', '51.648725298_-0.470419292939', '-29.7547605728_-53.8437224215', '40.8742248447_14.3472698415', '-19.4745408444_-42.6660148338', '-33.9225214406_151.215005812', '2.93696418715_101.743488347', '32.2911729514_-95.2831921969', '32.4889978839_-92.0952852914', '39.9425152757_0.24943733388', '45.4573376395_40.5987591772', '34.8078066578_138.321707819', '39.1630513482_-75.5208760996', '41.1315150875_16.8466423065', '-29.7852518782_-51.1551915838', '17.9531238989_-92.9527814405', '34.1143902616_-117.596370914', '-0.858371056816_119.919746085', '39.7924749469_-86.2408138456', '40.7825633306_-74.1111407122', '54.0026118787_-7.39799352162', '56.2598164883_-3.08071188083', '21.2925238961_-157.79495587', '30.8487178683_-83.2482917066', '32.6536315002_-83.1857642515', '52.2154127854_21.0731844374', '36.6964784625_-5.85429234895', '28.4306943196_-81.459514711', '54.5436234469_-1.53146294702', '54.8987756083_-7.2066537638', '-22.7342855049_-43.393230542', '-22.8225012875_-43.1973546362', '35.7333940374_139.838906399', '37.6281944809_-122.036715981', '48.6108592567_7.71116290936', '52.650542601_-1.15219640966', '26.7136053089_-80.1454495755', '37.701507021_-89.2119484037', '52.1809510384_0.147722159543', '39.7597053515_-83.8599879661', '41.595433267_-81.5399550314', '54.9047786751_-1.67431920387', '55.8047775525_-4.19655086505', '50.6857758268_-3.49545374806', '51.035026834_-1.35983177945', '-5.38295110099_105.225656659', '0.49713646855_101.470676887', '20.914940494_-89.6438425085', '41.1333629998_1.2724423183', '-20.746482063_-49.3191590865', '3.20896873577_101.38451415', '37.8985539257_-122.033202883', '41.1350878665_-73.3915376555', '53.4711162853_-2.17139863731', '20.1210668204_-98.3781487126', '34.1083607309_-118.355254138', '51.4690672772_-0.480372914787', '51.6455244921_0.326036808946', '52.8363690561_-1.58970902481', '55.8973088129_-3.87954717486', '31.8527356642_-106.426904919', '37.9776484107_-1.12132435747', '41.5910508455_1.86017907587', '42.1103156233_-72.5204733412', '47.8060044141_-122.265437868', '52.103804319_-0.736806147917', '-33.8323742982_151.216882312', '33.5465574939_-84.3612927308', '50.8509261122_-1.08215639817', '51.9456879558_-9.07274463631', '52.5436061526_-0.271757904368', '-28.310241064_-53.906301222', '-33.4746679582_-70.5605332681', '-5.19985223043_-37.3308611593', '32.6587938598_-97.1339447333', '38.8802014687_-76.7869372092', '-21.928937253_-51.3389087727', '30.2301339879_-97.7010081005', '39.6129862627_-75.6407271004', '51.6709657858_-4.08457093401', '53.4415091929_-6.21453434163', '55.0012466997_-3.39083031491', '-5.29244710092_-39.3158722353', '33.9311702102_-118.02787007', '42.3875842542_-83.125981749', '-19.939573389_-44.1877516303', '19.4894247281_-99.2382345648', '25.991332064_-80.1507412682', '40.0491057073_-82.9343188705', '59.3713289766_18.0961346577', '-6.28367512544_107.033738204', '43.0072755805_-83.6380115084', '50.9300518529_-0.509624253998', '-6.91337116242_107.669432957',
'19.579896318_-99.143020572', '34.0203913585_-118.137249238', '52.3913862565_-3.95518800691', '53.2653350271_-6.37598144505', '-23.4594301117_-46.3217458135', '33.8378676274_-118.350968762', '38.4431564688_27.1718874815', '41.406832172_-73.5044892796', '43.6619326817_-79.8217524654', '51.2829069988_-0.203740272581', '55.7944336139_49.006182549', '-23.6372495753_-46.6175931565', '35.0958929163_-106.700500336', '37.068872663_35.3059002148', '25.9015925805_-80.2512180932', '38.3273583128_-0.540379812385', '39.7023808998_-75.7581979194', '45.7233593385_4.86334675084', '32.8529811876_-117.160306925', '51.472071398_-0.624214492372', '30.0251678468_-90.1485854031', '51.9358025393_4.52734474002', '53.5489928306_-1.11327882467', '30.4945413881_-91.176585722', '39.3305401178_-76.7983475355', '21.0257660917_-87.0481181123', '41.5796608561_-73.020690803', '53.8333100201_-2.77207485407', '38.6132490851_-121.449408431', '40.6045876868_-74.4680996459', '23.2796097936_-109.777800127', '29.3018318341_47.9339732276', '30.9482891081_-91.3773643024', '41.0414808732_28.8441225999', '-22.5607972569_-50.465038546', '-6.2849559083_106.672300621', '29.8426271697_-90.0503366673', '40.3229480345_-82.7067199941', '41.8428921923_-71.3487291178', '-30.2364799964_-50.8441044216', '-19.8470666702_-43.806246658', '33.3909303469_-111.91394644', '35.0729784392_-89.906213219', '41.5963098618_-87.2999794467', '-6.1031982976_106.942724643', '-6.73360219826_108.512358811', '28.5022873636_77.2987978478', '42.8489334064_-1.59255563837', '44.4546349205_11.3252944394', '-8.09256759178_-34.8603737961', '53.1020356935_-1.2822811978', '53.472065881_-2.32204056734', '-23.0061479351_-43.487586621', '-7.01094912255_110.411500268', '40.7731937539_-73.2818082795', '47.6268385466_-122.401051993', '-22.102147016_-46.5995124898', '43.2825760421_5.40339268996', '43.5741909875_3.92884488325', '42.3087500197_-85.6046543067', '32.4919685126_-92.7338943876', '-21.6399681835_-47.4637029239', '-6.735695372_-35.0355585131', '32.6571634792_-97.027366074', '40.9351703968_-5.67258175278', '51.3113601204_-1.92392935727', '53.998159304_-1.09302101885', '59.3713289766_17.9038653423', '-23.4533486109_-46.908974434', '47.6282283307_-2.80034566326', '-28.9636457284_-49.4092887619', '45.4513244058_10.9822526423', '45.5520544286_10.2170956158', '36.0048487263_-79.9458931344', '39.7949436117_-75.0584013337', '52.5606889832_-1.15597539335', '53.5627082174_-2.47157301583', '-10.9853561313_-37.1238696776', '41.5053635191_-81.539206056', '42.5874024829_20.9390627381', '49.9648104009_8.23311820025', '52.3851766792_-1.45719127745', '-5.37756755457_-47.5716154855', '34.8352183666_-92.2891127331', '42.2902732008_-83.4865767297', '42.7401381008_-84.4955131805', '-1.4914061245_-48.5285834085', '44.9279912305_-93.3168007404', '50.8588801558_4.34979755661', '53.204109871_-2.77542693182', '-23.5505368398_-46.2246913879', '35.9919211288_-78.9477014136', '49.4079280627_11.136729292', '-27.6190068587_-51.0506759292', '-7.09806455749_-34.856099523', '14.5101460064_121.097725521', '41.3238552569_-81.7766863736', '-6.2833159594_107.124085289', '-6.28401870751_106.943385967', '-25.3606919075_-51.5466430807', '28.0696272255_-15.4579694038', '43.307815933_-3.06165205788', '-33.38450394_-70.5589201862', '18.3028029247_-66.8713363841', '34.0213451876_-118.028955919', '44.8989055676_-89.596451767', '3.11792828622_101.654044073', '41.7698985693_-88.2632934207', '47.9826532932_7.86089523919', '31.5595720757_-84.2082096297', '32.8489654563_-79.9847900294', '36.0838742892_-115.056363782', '37.5169276353_-77.432758568', '40.2345655848_-85.4130479318', '33.8144850711_-84.245083283', '35.4593312178_-97.5122680571', '38.788314359_-76.8997695665', '-19.47328888_-42.5708126142', '-3.11836861077_-41.4742259144', '30.2328534115_-92.0127212387', '33.6366566329_-84.3585461643', '38.1396267161_-6.20443867466', '39.1635112127_-75.4051289445', '51.3792356782_0.485311197801', '52.475046986_13.4540493982', '-7.00423727686_107.579500802', '19.656346543_-101.241271654', '37.8100787969_-122.26156404', '40.4238144982_-3.64835608078', '42.5675779732_-83.1320861191', '51.5588971509_-0.475409005116', '53.9083291387_-1.09711665106', '39.153741347_-76.5623870799', '40.603257207_-74.2317165824', '51.8314192476_-0.605343001199', '34.0193422037_-118.245537209', '36.1535468891_-95.9455987607', '14.5093757046_121.00497079', '35.0958929163_-85.2994996638', '-29.6914539171_-50.0180581676', '39.3177095229_-84.5060491133', '51.8314192476_0.605343001199', '3.38996965174_101.294996921', '50.9470467209_-1.50529138076', '53.3840774795_-9.07517293001', '55.9900655365_-3.24044725664', '-22.2880446436_-45.922202211', '41.3219947363_1.98436496663', '-8.1764937204_-36.0507709703', '25.8069877556_-100.346681613', '43.4871025585_-80.5671615413', '48.7070506578_2.5242652748', '53.3840774795_-2.92482706999', '-29.7850899723_-56.7413480635', '-31.2868959928_-54.1112767825', '33.2124974995_-87.5901798976', '-8.72540705713_115.136604971', '20.6570692372_-103.416117219', '40.8726375452_-74.1099370903', '53.6468550162_-1.71409733984', '34.7465177578_-86.6176217567', '39.42060332_-76.8006604423', '41.8642434636_-87.7831919365', '38.237316795_24.5434179298', '45.2854933934_-75.8288396596', '52.2126901864_-2.19501388538', '34.1155389679_-117.271082806', '52.4631422167_-0.71841436881', '-0.0452174025507_109.33768602', '53.5609933325_-2.16964324504', '55.9881902472_-3.72131318329', '-23.8156423215_-46.8160931946', '-25.795905143_-53.2440308622', '50.7719081141_-1.93635533776', '-5.10680072041_119.480370943', '37.5145435635_-77.5458101235', '38.8743986408_-77.1325910691', '41.9568392992_2.81900141717', '56.2539234693_43.7894735238', '-6.19423977702_106.762364761', '45.6463679053_9.70581523586', '25.9020737085_-80.3510501855', '31.7636806123_-106.319949829', '41.0433229708_28.7252002603', '43.1229663492_-88.0449201734', '19.5609119466_-90.3789753237', '25.6273161162_-100.245065708', '33.8418465864_-117.918718865', '40.8734922298_14.2286010991', '-23.9100630683_-46.424519262', '39.7726189646_-89.276806131', '42.2267775996_-8.69705399216', '1.04038548664_116.415775926', '35.1603492549_-89.9809280053', '42.9468329971_-8.57096617478', '-15.7637527679_-47.9396193477', '-26.7883778822_-48.7367758375', '43.7438562899_7.19917896674', '50.7705288142_-1.79456758107', '54.7191292002_25.2145945441', '-21.7409020199_-43.4045185566', '41.9550639454_-87.6636415667', '51.3760654317_-0.341776326788', '52.484941932_-8.7791071144', '-23.0954841174_-46.6110337771', '-6.82350178288_107.578520156', '-7.36966422246_112.76664276',
'1.40205946045_103.876394816', '37.4139133643_-6.00572033677', '40.947405837_29.0791011351', '51.6455244921_-0.326036808946', '20.6642802975_-105.144009894', '42.2997662064_-71.0017129913', '42.3875842542_-71.125981749', '-25.0709020723_-53.4288394225', '-6.10551932828_106.129636933', '4.65579500267_101.208450113', '-33.4732664537_-70.6681177759', '25.9918841029_-80.2506467899', '36.0939623991_-94.1663750032', '50.1466973911_8.6500985459', '51.9115568764_-0.164834859231', '53.1142186769_8.77589558099', '-2.94032826759_104.775037705', '51.1301515963_4.21477171123', '-6.10351678358_106.852398185', '33.816850366_-84.353016262', '35.1042323963_135.932660145', '46.4554396193_38.1535842545', '51.5674075933_5.09214658896', '63.7764585953_-96.2611691488', '23.9165921488_-104.852618377', '43.0339848752_-87.9206558866', '55.8031221973_-4.35604374594', '34.7244803379_137.34804495', '-23.819766626_-46.4235317617', '50.6574304727_5.61742193713', '51.4955881921_-2.6398698104', '-19.0192363378_-48.3875882926', '36.8081626337_-4.73760992497', '36.994114754_-76.2923522713', '39.137660115_-84.5124173678', '54.6215791365_-6.75415674915', '40.5131760028_-3.76725427773', '42.657572437_-71.1351593543', '51.6385909867_0.0373556729699', '35.0755561605_-89.7966631883', '40.7825633306_-111.888859288', '55.7114384245_37.4879606994', '-19.4881711255_-44.2853147015', '33.4844815244_-86.9461798168', '36.8887294665_30.6995319928', '39.97088439_-86.0046454054', '42.4752581298_-83.2505968631', '52.9223279845_-1.28940389733', '53.3517269804_-6.22039524686', '30.2192607051_-90.8700408342', '40.9514451206_28.8416142832', '51.465886884_0.336556963377', '-22.1971355252_-49.9813883136', '-22.8162468345_-47.2895790669', '-26.3518469687_27.952090151', '51.465886884_-0.336556963377', '33.9921804503_-84.1311303631', '36.2640836526_-115.051906556', '40.7834153212_-74.2296442948', '41.7528980527_-72.6545563497', '27.9722185298_-82.4742686757', '50.8485058793_-0.940188596679', '54.10294683_-2.77059889186', '41.7755684813_-87.5414632499', '34.7450477852_-92.2898861188', '39.975024849_-75.1756629246', '49.247751457_-123.068701085', '-14.8792852804_-39.325375429', '-24.001240872_-46.3272218461', '47.1775645441_-122.538095728', '52.478528041_-1.74843086468', '53.5598501493_-2.01869174635', '55.8929486358_-4.35917520708', '41.6603927638_-71.462180394', '44.7406855682_10.326258782', '14.6005116263_121.096950958', '35.9761326062_-77.8281104012', '38.7843449188_-77.1299047019', '33.9280333711_-118.352390874', '41.595433267_-87.5399550314', '35.5507797444_139.620900347', '41.1295441626_28.9657154824', '48.6180513756_9.06784245618', '53.4739651937_-2.92466831536', '33.9291739777_-118.244222935', '33.9348780765_-117.378712057', '39.9751431602_-74.9414455764', '-30.0558287911_-51.2593527268', '19.3086804383_-99.2379716438', '34.7456357603_-92.3991286065', '38.7821904089_-77.2449546138', '51.5860355059_-2.92783114428', '32.8319998247_-96.7030622165', '38.7017516198_-121.332505486', '39.8807988136_-3.99405075628', '40.0651221405_-75.1758941128', '45.8111443441_4.99498274432', '19.5609119466_-101.621024676', '42.3897723059_-71.0045714566', '29.8531718379_-95.432609054', '3.66405627181_98.6848254732', '35.8097791698_-78.8417352959', '39.975024849_32.8243370754', '41.9303514291_12.5274593237', '-33.0081335133_-71.5155332685', '-6.92059747074_-38.5021315609', '18.9471811487_-99.2374545728', '52.1907400202_5.41392602856', '33.6389122778_-84.4662665755', '35.9734682991_-83.9388880538', '37.8856996982_139.009957326', '60.3444383926_5.46604674445', '37.8107361445_-122.375162799', '41.2329199894_-75.8949322933', '-21.5673258953_-45.4346492589', '36.175735059_-115.1652792', '36.7237441639_-76.2878071393', '42.3897723059_-83.0045714566', '52.5722686549_-2.18844483719', '52.9853035758_0.0540299078351', '2.75580114295_101.922780847', '37.3432761107_126.911485627', '38.351470186_-81.6294558786', '55.7132943221_37.6470700103', '18.8477574636_-97.1491998999', '35.8245578094_-85.9482824758', '55.8991777235_-3.55973389792', '-21.1157935521_-50.6629718524', '29.2438166552_-81.0514559517', '36.992838217_-76.4047012289', '38.6921420211_-77.2421360595', '54.5416486915_-1.37694563443', '-6.55591510286_106.763600323', '36.0856238862_-115.167376037', '-8.45375013469_115.047131203', '35.5507797444_-97.620900347', '53.7424693544_-2.46932043347', '-2.3968105568_106.394019383', '-33.383107197_-70.6663936082', '35.807741637_-78.7311309828', '37.811283951_-122.488764945', '38.7724413113_-90.2949784884', '-22.9148869572_-46.6088908435', '57.666965691_11.7662712571', '-5.92136156155_-35.2129426233', '25.7210061306_-80.2523525571', '26.6233251999_-81.8538779669', '40.2453125028_-74.8236403744', '42.3037442791_-85.2408003066', '19.3088293766_-99.0475944752', '32.5483335035_-83.92845293', '33.4843880369_-80.8385396989', '37.4167203193_-5.88142121144', '45.0106764746_7.66752396263', '51.3760654317_12.3417763268', '30.4780635756_-84.2395895467', '39.2422043745_-76.6802193014', '40.6924876762_-74.1123389009', '54.9119844975_-2.92200719338', '-30.2999392365_-54.3485365472', '33.7371300248_-78.8950633689', '40.5149845872_-3.41314940652', '50.8664910267_-2.78684325615', '-22.7286505359_-47.0934482792', '38.8935201782_-104.711720744', '44.2082046522_20.9374164602', '49.8643550736_-97.2606677336', '53.8335024565_-3.07597534299', '33.569518966_-112.131301902', '51.3727195488_-0.198268351783', '-2.57488531412_-60.0121904923', '32.8357381773_-96.9166024125', '-37.7956226867_145.012377032', '27.7043801195_-109.833593733', '32.2804599106_-90.1863311057', '48.8863176929_2.38615706391', '-20.2981173391_-40.2929342196', '-27.9785306851_-50.3390495943', '34.198522343_-118.356695345', '39.4051816666_-0.386807374139', '41.9436545469_-88.7492633073', '53.3736672284_-1.42169617456', '-6.91386971822_107.579007197', '38.4432685338_27.0572959333', '-33.5634243179_-70.669849635', '38.3530340008_27.1716742205', '40.8716608061_-73.9912785426', '43.0972299084_12.3581275523', '-8.90248219477_-36.4994710927', '33.8390043845_-118.242914494', '42.3852677413_-83.247378133', '43.1871825371_-77.6457512092', '-5.74056982204_-35.2122340074', '24.6213005404_-107.321331197', '34.7177274164_137.675382362', '38.6020920702_-77.2393300747', '5.38158766994_100.308696493', '-16.680364312_-49.2651217373', '-6.10410833085_106.671731433', '23.7275399881_-166.618705601', '34.1123801983_-117.921633694', '-25.441699935_-49.2596725586', '-5.83096584727_-35.2125855218', '-7.27924911979_112.766286701', '-7.82489116222_110.319716843', '40.9627103191_-74.1087280071', '54.9946195131_-1.67135880362',
'60.1982829774_25.1060081042', '-22.8133291068_-48.5156986819', '-29.597520648_-52.3940603442', '-29.6950832047_-51.051684301', '30.3879284365_-84.2421287703', '48.976269757_2.38505329862', '-23.5447989133_-46.812351976', '40.4202091022_-79.880179662', '40.8734922298_-74.2286010991', '51.738551717_0.46540360075', '33.5509600985_-84.5765218281', '37.0815674181_-76.5188369127', '44.9043824836_-0.656637310679', '51.4690672772_5.51962708521', '-22.2636871494_-41.9593886872', '29.6887929464_-82.2919709521', '53.3821843451_-2.32346917355', '-18.8344670216_-41.8940334346', '41.1315150875_1.15335769349', '48.7955599744_2.25110094652', '-2.94030640229_104.685053572', '-23.0007383828_-47.0000872309', '33.5442161177_-84.2536962161', '40.0648847684_-74.7068443049', '-23.9994129816_-46.5237965579', '25.8112999221_-80.2517866792', '27.6812180859_-83.7881239004', '28.6115293321_-81.3580115225', '30.1130053753_-95.9576701707', '32.3705641641_-90.1835408512', '38.8743986408_-6.86740893094', '40.5123320512_-3.88528091068', '42.6527660431_-71.378983185', '43.7474995712_-79.4474709137', '47.6260664822_-122.267962622', '-23.5552894374_-51.1469758117', '36.0959188728_140.055761319', '52.3809770619_13.163473719', '52.5698787069_-1.89338575598', '-6.10382012925_106.762067039', '-7.27312993044_-35.9429639004', '28.0635170825_-82.3737648094', '51.6545946344_-0.75926072396', '41.0450424098_28.6062672635', '41.6652866156_-72.7778490244', '24.0972371485_-110.852412437', '25.7214834211_-80.3520334237', '40.9606282444_-73.8710948808', '42.6552340547_-83.2570787387', '50.4015218846_-4.89964261601', '51.1268340855_10.5005053291', '53.8040789997_-0.342437494274', '20.6483149518_-101.351418411', '34.1115188099_-118.030046606', '-23.6270920019_-47.4014328528', '40.1487895985_-88.2327522689', '39.0545014338_-77.1379999951', '42.2075841562_-71.1199330135', '54.7266831945_-1.83542456072', '-23.6350811627_-46.8135928575', '13.6999326738_100.433333683', '29.3018318341_48.0660267724', '30.2209077186_-90.9738854419', '51.103276492_-0.214599863696', '53.3840774795_-3.07517293001', '-28.7819494935_-49.3096218056', '-30.0559924674_-51.1556120628', '48.1383451403_11.621213124', '55.8062260899_-4.037042359', '-23.7294690883_-46.422549141', '25.8086987812_-100.147207826', '27.4369059069_-80.3423058566', '-20.1955812921_-41.4401995219', '-8.00216023537_-34.8599613865', '36.1562287444_-119.834568998', '37.2531963282_-6.91397585838', '38.8887380866_-1.90462557568', '2.21402850336_102.258059122', '33.8212979497_-84.5689187479', '36.8160887584_-76.0651255564', '37.7206089135_-122.375920633', '-23.724180272_-46.9128979469', '3.1181522981_101.564138183', '41.9543031256_-87.7842935894', '-23.2675532621_-47.2972232214', '14.6908765072_121.096171055', '51.4800254349_7.05587841924', '22.2868256741_-97.8836757231', '34.0222036762_-117.920657761', '36.1739797098_-115.054140117', '41.7741823608_-87.7820952965', '36.5408736367_-82.5081910059', '38.8764465062_-77.017384295', '51.4044375384_-2.35305307136', '38.5998388835_-77.354079774', '32.839112484_-97.1301801765', '51.73195168_0.17609533112', '57.1549403487_-2.09082118805', '10.3566192769_123.959090547', '30.0228807575_-90.04501088', '37.2490096866_-119.31138094', '51.4589975864_0.0490077528107', '35.0908314682_-78.9705392464', '39.8846902814_32.7076131899', '40.6892121177_-73.757342573', '53.6432239565_-1.41164767557', '-20.5667433482_-40.5829491872', '-23.6391704584_-70.421571385', '52.0978400837_11.5549225774', '21.5678298016_39.1448844947', '34.5613932692_-118.144562783', '47.3575255009_8.53652746172', '27.8896106788_-110.74599361', '42.3114459117_-7.84727046584', '51.73195168_-0.17609533112', '52.6647421545_-2.77820168224', '-9.35154458334_-35.8675582892', '40.1552180253_-75.1761263447', '20.7473941409_-103.415178604', '39.2404754044_-76.7960449767', '41.1459331712_-80.7020823706', '-23.0910169947_-47.0014213111', '-8.00329677823_112.587849526', '33.9353534982_-117.162306436', '35.0889461796_-78.8609048894', '40.0574089576_-85.6516517963', '52.2971251568_-1.60690367079', '38.8699623155_-77.3629678367', '51.3792356782_-0.485311197801', '28.3407345684_-81.3570996274', '34.7152813099_137.78446976', '38.8722372317_-77.247785799', '50.743993905_0.235987310512', '33.5745837671_-86.8383719749', '34.0256380324_-80.9458406039', '36.7016338934_-6.36935070068', '45.4683662279_9.19188815632', '-19.4819051825_-40.6673844672', '-29.4207372122_-51.9793274578', '33.7516660223_-117.917755866', '39.7937680197_-86.4743982775', '35.6421343496_139.729779409', '43.7491190066_-79.5716335057', '-12.0687070615_-77.0670051923', '-6.46483779903_-37.0559330108', '3.02777295376_101.563922355', '51.5487952132_0.0431968072903', '55.8946095543_-4.19931424452', '-20.8314124159_-41.1621384049', '13.7885516158_100.711328792', '30.0515737713_-94.0892038036', '34.8978843495_138.318785058', '52.5401177196_6.12448210232', '40.7494846119_-77.9019992524', '51.7519361597_-1.18910602534', '-22.2796303001_-49.1073602411', '32.2134935954_-82.4325112972', '-26.4332627757_-49.144773892', '36.7891531438_-119.745686163', '39.885044088_-74.9415222936', '40.9594035924_-109.75228838', '-14.2366711295_-53.1778952845', '1.8546462793_104.595389199', '31.2976332796_-89.363922438', '33.6318643156_-101.856857445', '36.8138691169_-76.2893154519', '51.2923873424_-0.633504542489', '54.9861877717_82.9535439053', '-15.7661922583_-47.7531371886', '-21.7240281875_-48.1483969743', '38.9735831709_-94.5584199951', '19.5797955219_-99.2383671282', '38.1642405359_-85.5731134251', '38.5897026851_-90.1870592767', '39.4101663298_-77.3811059297', '41.9276918188_12.4069640901', '53.3821843451_-8.32346917355', '55.9002160754_-3.23989120909', '-1.31053951938_-48.4389693775', '41.5948071505_-93.6599380784', '51.0402481042_13.787581123', '52.1963615606_-0.878438786094', '52.3924822435_9.80825332291', '53.1896314968_-1.12909603312', '53.3551300873_-6.37046574702', '-27.0674825381_-52.6639082655', '19.5672030059_-96.8552489132', '34.1723291756_-77.8749562541', '41.0549933947_-81.535511808', '-23.9117578195_-46.2280718342', '19.3991528252_-99.142861936', '36.0928297952_-79.7225654296', '41.5031166668_2.10135722683', '57.774736865_-4.76542113888', '-21.8368891037_-51.8225192043', '1.311562115_103.786564514', '32.9240538414_-96.8076084059', '37.8909722159_-4.64903590926', '41.4146701561_-81.6581114761', '41.8633586589_-87.9036695064', '50.05255738_19.9523416123', '40.6024105828_-74.1135316841', '40.6904252269_-73.8756680768', '42.2052821201_-83.2409846933', '51.5588971509_0.475409005116', '19.6701654103_-99.2385004293', '35.0148626207_135.822041859',
'51.4950574649_-2.49582287638', '53.5598501493_9.98130825365', '-34.5578899507_-58.4714960441', '37.5396992636_-122.264238862', '45.5580894432_-122.679677792', '1.49241469359_103.696595427', '23.6456166967_-99.1470765099', '34.6559502222_135.49109292', '-31.5832830204_-52.3174002095', '14.4190143488_121.005777471', '36.1773872991_-115.276427615', '37.9794115986_-121.235132144', '53.1939552219_-1.42830566296', '6.01592617843_116.412658353', '-33.5648305937_-70.5621535462', '25.6254830948_-100.444229416', '27.9793574646_-15.4575875195', '39.1504091813_-76.793752715', '53.2838119774_-1.42500978388', '54.9928124418_-1.51510349407', '51.3691981086_0.0547887150973', '51.7283849047_-0.0314841423471', '29.5807401234_-95.5292473446', '32.3118138815_-116.946884394', '41.5039904139_2.22116480895', '53.8281148665_-1.86049345808', '39.9751431602_-75.0585544236', '40.7764787058_-73.5187187703', '52.9243759257_-1.43808818319', '-23.2816202709_-45.9289064519', '-6.19291610415_107.123721246', '34.3597123397_-89.5552392263', '37.2467557126_-77.4240412731', '42.5788484504_-94.401353403', '-33.9092236128_18.4582913501', '13.2393485783_-59.5376393672', '25.7204606747_-80.1526743898', '-2.48782216597_-44.3253779533', '-6.19327006362_107.03338962', '39.4344116051_2.82570257762', '-17.4107880883_-50.9529228479', '-6.46549677045_106.763284723', '39.8525195572_-84.2530355606', '48.1413311331_11.4869268258', '32.5483335035_-89.92845293', '40.6050715189_-75.4137036227', '48.2495114129_7.58555859553', '61.7307111607_34.4194863352', '-23.5436269479_-46.9102757662', '-6.73933169323_-38.2308696904', '35.8956860983_-78.6178436624', '40.8551852917_29.1948466515', '-29.1530862485_-51.3598734488', '-7.9154789163_110.410289896', '29.7630046674_-95.430426613', '39.8807988136_-86.0059492437', '-22.9127923117_-43.196162571', '39.7047245428_-104.82502443', '40.0652408276_-74.9413685131', '51.103276492_-114.214599864', '32.3995149827_-81.7974923881', '33.7243969521_-84.2479670323', '36.5361650825_-4.84320189994', '41.0494644797_-100.249411664', '-23.547945217_-46.5185449381', '19.0359438462_-98.1922458303', '50.4076483974_4.47767038956', '-20.3877205092_-40.3894941294', '36.796437912_-119.409768403', '39.8843364809_-75.4093391232', '27.7894181474_-82.6747700791', '38.2396522124_-0.657587205211', '4.7490807479_-74.0532052931', '50.8370997463_-0.372534002177', '39.9570495203_-83.0487872882', '48.7978118794_9.20425363407', '20.5648834141_-100.774756302', '37.1798162887_-3.61960258359', '39.8846902814_-75.2923868101', '52.6527549244_1.299946787', '-29.0633014851_-51.0513660612', '36.5190147374_-6.2638959427', '38.890673558_-80.1352029995', '40.9452029237_29.1978257432', '51.5619108949_-0.619533292892', '32.490348108_-93.6918560827', '39.8843364809_116.590660877', '51.205343596_6.78113954372', '-2.66875213314_-44.3252826538', '-29.0621222932_-51.5650154125', '34.8296148514_-82.3669651082', '32.3995149827_-93.7974923881', '37.7992357214_-121.239429055', '38.1612453322_13.3448934237', '-22.1856988872_-54.8177344764', '-23.1020063952_-45.7323768059', '30.0435576457_31.1849041334', '52.4812766258_-2.04286620232', '53.7367161316_-1.71135574767', '19.3990530324_-99.2381027373', '29.6688895908_-95.6347391863', '35.9036590226_-79.0607816022', '18.3831417765_-66.1135927564', '19.3087797303_-99.1427832791', '39.3353970615_-76.4503971881', '30.4823063219_-90.4477415578', '38.1655718826_-85.6872354956', '41.8403668553_-71.4690715068', '29.5137795488_-98.5356752307', '49.2255383176_-84.733794451', '-21.9027912216_-47.9518721194', '-23.6187362833_-48.108922482', '19.3077868499_-99.6187148526', '30.3250674071_-81.6761472748', '33.4843880369_-86.8385396989', '37.5380718428_-122.037876616', '43.4818869778_10.174742278', '54.1924331077_-8.6168388889', '35.2878504981_-80.725066437', '-7.37001277601_112.676072846', '33.6293277173_-83.9645396498', '59.9169265261_30.4064518239', '-1.22138208752_116.865168483', '1.31151663822_103.696695481', '21.0954597814_-101.64702644', '32.7627749824_-117.160145076', '38.0804457253_-122.258853203', '52.1065158619_5.11729297012', '30.4802264109_-84.343660022', '-22.4707541528_-44.5625861984', '36.4263608794_-6.15563498896', '-17.1313071499_-46.8329835231', '-33.3816174566_-70.773859371', '19.196988282_-96.1947128863', '3.02755544663_101.653820699', '40.3321706767_-3.88292212466', '59.9094111002_30.0492406175', '19.1229208269_-103.621416054', '20.6637994255_-98.5679744289', '25.6264335215_-100.344649982', '26.3524779135_-80.1481204709', '52.4730318864_13.3068828195', '19.3992027219_-99.0476206943', '29.6709030092_-95.5315017611', '33.6648723051_-80.9460677507', '34.9968576526_-90.7537497994', '49.8768813434_8.65205218293', '53.0217100308_-2.18003547809', '41.0374288347_29.0819323771', '-23.8206416384_-46.3253783648', '61.5273920646_0.0850577310614', '41.3229869932_2.1038364943', '42.2847589616_-83.728914585', '-22.5440391761_-48.6177411216', '14.8784565887_-92.3027813649', '26.7136053089_-81.8545504245', '3.02798298524_101.474017635', '38.8675739308_-77.4781365343', '38.9822627539_-92.3649968438', '41.0414808732_-85.1558774001', '40.2271654301_29.0569061185', '54.6085129124_-5.86461944396', '1.40201431613_103.786519439', '32.9221325918_-96.7007353016', '34.1996745462_-79.7518166497', '39.9747882288_-75.2927703872', '42.9404021242_-85.7130395737']


# Parameters for the MR Job that will be logged.
HASHTAG_STARTING_WINDOW = time.mktime(START_TIME.timetuple())
HASHTAG_ENDING_WINDOW = time.mktime(END_TIME.timetuple())
PARAMS_DICT = dict(PARAMS_DICT = True,
                   MIN_HASHTAG_OCCURRENCES = MIN_HASHTAG_OCCURRENCES,
                   MIN_HASHTAG_OCCURRENCES_PER_UTM_ID = \
                   MIN_HASHTAG_OCCURRENCES_PER_UTM_ID,
                   HASHTAG_STARTING_WINDOW = HASHTAG_STARTING_WINDOW,
                   HASHTAG_ENDING_WINDOW = HASHTAG_ENDING_WINDOW)

def iterateHashtagObjectInstances(line):
    data = cjson.decode(line)
    l = None
    if 'geo' in data: l = data['geo']
    else: l = data['bb']
    t = time.mktime(getDateTimeObjectFromTweetTimestamp(data['t']).timetuple())
    for h in data['h']: yield h.lower(), [l, t]

class TweetStats(ModifiedMRJob):
    DEFAULT_INPUT_PROTOCOL='raw_value'
    def __init__(self, *args, **kwargs):
        super(TweetStats, self).__init__(*args, **kwargs)
        self.num_of_tweets = 0
    def map_tweet_to_tweet_stats(self, key, line):
        if False: yield # I'm a generator!
        self.num_of_tweets+=1
    def map_final_tweet_to_tweet_stats(self):
        yield 'total_tweets', self.num_of_tweets
    def red_tuo_tweet_stats_and_values_to_tweet_stats(self, key, values):
        yield 'total_tweets', {'total_tweets': sum(values)} 
    def steps(self):
        return [self.mr(
                    mapper=self.map_tweet_to_tweet_stats,
                    mapper_final=self.map_final_tweet_to_tweet_stats,
                    reducer=self.red_tuo_tweet_stats_and_values_to_tweet_stats)
                ]
        
class HashtagsExtractor(ModifiedMRJob):
    '''
    hashtag_object = {'hashtag' : hashtag,
                      'ltuo_occurrence_time_and_occurrence_utm_id': [],
                      'num_of_occurrences' : 0
                    }
    '''
    DEFAULT_INPUT_PROTOCOL='raw_value'
    def __init__(self,
                 min_hashtag_occurrences = MIN_HASHTAG_OCCURRENCES,
                 *args,
                 **kwargs):
        super(HashtagsExtractor, self).__init__(*args, **kwargs)
        self.min_hashtag_occurrences = min_hashtag_occurrences
        self.mf_hastag_to_ltuo_occ_time_and_occ_utm_id = defaultdict(list)
    def map_tweet_to_hashtag_object(self, key, line):
        if False: yield # I'm a generator!
        for hashtag, (location, occ_time) in \
                iterateHashtagObjectInstances(line):
            utm_id = UTMConverter.getUTMIdInLatLongFormFromLatLong(
                                                    location[0],
                                                    location[1],
                                                    accuracy=ACCURACY)
            self.mf_hastag_to_ltuo_occ_time_and_occ_utm_id[hashtag]\
                            .append((occ_time, utm_id))
    def map_final_tweet_to_hashtag_object(self):
        for hashtag, ltuo_occ_time_and_occ_utm_id in \
                self.mf_hastag_to_ltuo_occ_time_and_occ_utm_id.iteritems():
            hashtag_object = {'hashtag': hashtag,
                              'ltuo_occ_time_and_occ_utm_id': \
                                    ltuo_occ_time_and_occ_utm_id
                             }
            yield hashtag, hashtag_object
    def reduce_tuo_hashtag_and_hashtag_objects_to_combined_hashtag_object(
                                                  self,
                                                  hashtag,
                                                  hashtag_objects):
        combined_hashtag_object = {'hashtag': hashtag,
                                   'ltuo_occ_time_and_occ_utm_id': []
                                }
        for hashtag_object in hashtag_objects:
            combined_hashtag_object['ltuo_occ_time_and_occ_utm_id']+=\
                    hashtag_object['ltuo_occ_time_and_occ_utm_id']
        combined_hashtag_object['num_of_occurrences'] = \
           len(combined_hashtag_object['ltuo_occ_time_and_occ_utm_id']) 
        e = min(combined_hashtag_object['ltuo_occ_time_and_occ_utm_id'], 
                key=lambda t: t[0])
        l = max(combined_hashtag_object['ltuo_occ_time_and_occ_utm_id'], 
                key=lambda t: t[0])
        if combined_hashtag_object['num_of_occurrences'] >= \
                self.min_hashtag_occurrences and \
                e[0]>=HASHTAG_STARTING_WINDOW and \
                l[0]<=HASHTAG_ENDING_WINDOW:
            combined_hashtag_object['ltuo_occ_time_and_occ_utm_id'] = \
                sorted(combined_hashtag_object['ltuo_occ_time_and_occ_utm_id'],
                       key=itemgetter(0))
            yield hashtag, combined_hashtag_object
    def jobs_to_extract_hashtags(self):
        return [self.mr(
        mapper=self.map_tweet_to_hashtag_object,
        mapper_final=self.map_final_tweet_to_hashtag_object,
        reducer=
        self.reduce_tuo_hashtag_and_hashtag_objects_to_combined_hashtag_object)
        ]
    def steps(self):
        return self.jobs_to_extract_hashtags()
        
class HashtagsByUTMId(ModifiedMRJob):
    '''
        utm_object = {'utm_id': utm_id
                      'mf_hashtag_to_count': mf_hashtag_to_count,
                      'total_hashtag_count': total_hashtag_count
                    }
    '''
    DEFAULT_INPUT_PROTOCOL='raw_value'
    def __init__(self, *args, **kwargs):
        super(HashtagsByUTMId, self).__init__(*args, **kwargs)
        self.mf_utm_id_to_mf_hashtag_to_count = defaultdict(dict)
        self.mf_utm_id_to_total_hashtag_count = defaultdict(int)
        self.hashtags_extractor = HashtagsExtractor()
    def map_hashtag_object_to_utm_object(self, hashtag, hashtag_object):
        if False: yield # I'm a generator!
        for occ_time, occ_utm_id in \
                 hashtag_object['ltuo_occ_time_and_occ_utm_id']:
            if hashtag not in self.mf_utm_id_to_mf_hashtag_to_count[occ_utm_id]:
                self.mf_utm_id_to_mf_hashtag_to_count[occ_utm_id][hashtag] = 0.0
            self.mf_utm_id_to_mf_hashtag_to_count[occ_utm_id][hashtag]+=1
            self.mf_utm_id_to_total_hashtag_count[occ_utm_id]+=1
    def map_final_hashtag_object_to_utm_object(self):
        for utm_id, mf_hashtag_to_count in \
                self.mf_utm_id_to_mf_hashtag_to_count.iteritems():
            yield utm_id, {
                           'mf_hashtag_to_count': mf_hashtag_to_count,
                           'total_hashtag_count': 
                                self.mf_utm_id_to_total_hashtag_count[utm_id]
                        }
    def _get_valid_combined_utm_object(self, utm_id, utm_objects):
        combined_utm_object = {'utm_id': utm_id,
                               'mf_hashtag_to_count': defaultdict(float),
                               'total_hashtag_count' : 0.0
                               }
        for utm_object in utm_objects:
            if utm_object['mf_hashtag_to_count']:
                mf_hashtag_to_count = utm_object['mf_hashtag_to_count']
                for hashtag, count in mf_hashtag_to_count.iteritems():
                    combined_utm_object['mf_hashtag_to_count'][hashtag]+=count
            if utm_object['total_hashtag_count']:
                combined_utm_object['total_hashtag_count']+=\
                                        utm_object['total_hashtag_count']
        if combined_utm_object['total_hashtag_count'] >= \
                MIN_HASHTAG_OCCURRENCES_PER_UTM_ID:
            return combined_utm_object
    def red_tuo_utm_id_and_utm_objects_to_combined_utm_object(self,
                                                             utm_id,
                                                             utm_objects):
        combined_utm_object = self._get_valid_combined_utm_object(utm_id,
                                                                  utm_objects)
        if combined_utm_object: yield utm_id, combined_utm_object
    def jobs_to_get_utm_object(self):
        return self.hashtags_extractor.jobs_to_extract_hashtags() +\
                [self.mr(
                    mapper=self.map_hashtag_object_to_utm_object,
                    mapper_final=self.map_final_hashtag_object_to_utm_object,
                    reducer=
                    self.red_tuo_utm_id_and_utm_objects_to_combined_utm_object)
                ]
    def steps(self):
        return self.jobs_to_get_utm_object()
        
class HastagsWithUTMIdObject(ModifiedMRJob):
    '''
    hashtag_with_utm_object = {'hashtag' : hashtag,
                              'mf_utm_id_to_hashtag_occurrences': {
                                'total_num_of_occurrences' : 0,
                                  },
                            }
    '''
    DEFAULT_INPUT_PROTOCOL='raw_value'
    def __init__(self, *args, **kwargs):
        super(HastagsWithUTMIdObject, self).__init__(*args, **kwargs)
        self.hashtags_by_utm_id = HashtagsByUTMId()
        self.mf_hashtag_to_mf_utm_id_to_hashtag_occurrences = defaultdict(dict)
        
    def map_utm_object_to_hashtag_with_utm_object(self,
                                                      utm_id,
                                                      utm_object):
        if False: yield # I'm a generator!
        for hashtag, count in utm_object['mf_hashtag_to_count'].iteritems():
            if utm_id not in \
                    self.mf_hashtag_to_mf_utm_id_to_hashtag_occurrences\
                                                                    [hashtag]:
                self.mf_hashtag_to_mf_utm_id_to_hashtag_occurrences\
                        [hashtag][utm_id] = 0.0
            self.mf_hashtag_to_mf_utm_id_to_hashtag_occurrences\
                        [hashtag][utm_id]+=count
    def map_final_utm_object_to_hashtag_with_utm_object(self):
        for hashtag, mf_utm_id_to_hashtag_occurrences in \
                self.mf_hashtag_to_mf_utm_id_to_hashtag_occurrences.iteritems():
            mf_utm_id_to_hashtag_occurrences['total_num_of_occurrences'] = \
                sum(mf_utm_id_to_hashtag_occurrences.values())
            hashtag_with_utm_object = {'hashtag' : hashtag,
                                       'mf_utm_id_to_hashtag_occurrences': \
                                            mf_utm_id_to_hashtag_occurrences
                                    }
            yield hashtag, hashtag_with_utm_object
    def red_tuo_h_and_hashtag_with_utm_object_to_h_and_com_h_with_utm_object(
                                                 self,
                                                 hashtag,
                                                 hashtag_with_utm_objects):
        mf_utm_id_to_hashtag_occurrences = defaultdict(float)
        for hashtag_with_utm_object in hashtag_with_utm_objects:
            for utm_id, hashtag_occurrences in \
                    hashtag_with_utm_object\
                        ['mf_utm_id_to_hashtag_occurrences'].iteritems():
                mf_utm_id_to_hashtag_occurrences[utm_id]+=hashtag_occurrences
        combined_hashtag_with_utm_object = {'hashtag' : hashtag,
                                   'mf_utm_id_to_hashtag_occurrences': \
                                        {'total_num_of_occurrences' : 
                                         mf_utm_id_to_hashtag_occurrences\
                                                ['total_num_of_occurrences']
                                        }
                                }
        for dense_utm_id in dense_utm_ids:
            combined_hashtag_with_utm_object\
                ['mf_utm_id_to_hashtag_occurrences'][dense_utm_id] = \
                    mf_utm_id_to_hashtag_occurrences.get(
                                            mf_utm_id_to_hashtag_occurrences,
                                            0.0
                                        )
        yield hashtag, combined_hashtag_with_utm_object
    def jobs_to_get_hashtags_with_utm_id_object(self):
        return self.hashtags_by_utm_id.jobs_to_get_utm_object() + \
                [self.mr(
                    mapper=self.map_utm_object_to_hashtag_with_utm_object,
                    mapper_final=
                        self.map_final_utm_object_to_hashtag_with_utm_object,
                    reducer=
                    self.red_tuo_h_and_hashtag_with_utm_object_to_h_and_com_h_with_utm_object)
                ]
    def steps(self):
        return self.jobs_to_get_hashtags_with_utm_id_object()
        
if __name__ == '__main__':
    pass
#    TweetStats.run()
#    HashtagsExtractor.run()
#    HashtagsByUTMId.run()
    HastagsWithUTMIdObject.run()
